{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\aaron\\\\OneDrive\\\\Documents\\\\GitHub\\\\Fullstack\\\\part7\\\\bloglist\\\\frontend\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport { useState, useEffect, useRef } from 'react';\nimport Blog from './components/Blog';\nimport BlogForm from './components/BlogForm';\nimport LoginForm from './components/LoginForm';\nimport Notification from './components/Notification';\nimport Togglable from './components/Togglable';\nimport blogService from './services/blogs';\nimport loginService from './services/login';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nrequire('express-async-errors');\nconst App = () => {\n  _s();\n  const [blogs, setBlogs] = useState([]);\n  const [errorMessage, setErrorMessage] = useState(null);\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [user, setUser] = useState(null);\n  const blogFormRef = useRef();\n  useEffect(() => {\n    blogService.getAll().then(blogs => {\n      blogs.sort((a, b) => a.likes < b.likes ? 1 : -1);\n      setBlogs(blogs);\n    });\n  }, []);\n  useEffect(() => {\n    const loggedUserJSON = window.localStorage.getItem('loggedBlogAppUser');\n    if (loggedUserJSON) {\n      const user = JSON.parse(loggedUserJSON);\n      setUser(user);\n      blogService.setToken(user.token);\n    }\n  }, []);\n  const handleLogin = async event => {\n    event.preventDefault();\n    try {\n      const user = await loginService.login({\n        username,\n        password\n      });\n      window.localStorage.setItem('loggedBlogAppUser', JSON.stringify(user));\n      blogService.setToken(user.token);\n      setUser(user);\n      setUsername('');\n      setPassword('');\n    } catch (exception) {\n      setErrorMessage('wrong username or password');\n      setTimeout(() => {\n        setErrorMessage(null);\n      }, 5000);\n    }\n  };\n  const handleLogout = () => {\n    setUser(null);\n    window.localStorage.removeItem('loggedBlogAppUser');\n  };\n  const addBlog = blogObject => {\n    blogFormRef.current.toggleVisibility();\n    setErrorMessage(`a new blog ${blogObject.title} by ${blogObject.author} added`);\n    setTimeout(() => {\n      setErrorMessage(null);\n    }, 5000);\n    blogService.create(blogObject).then(returnedBlog => {\n      setBlogs(blogs.concat({\n        ...returnedBlog,\n        user: user\n      }));\n    });\n  };\n  const handleLike = async id => {\n    const blogObject = blogs.find(blog => blog.id === id);\n    const newBlog = {\n      ...blogObject,\n      likes: blogObject.likes + 1,\n      user: user.id\n    };\n    delete newBlog.id;\n    await blogService.update(id, newBlog);\n    setBlogs(blogs.map(blog => blog.id === blogObject.id ? {\n      ...blog,\n      likes: blog.likes > 0 ? blog.likes + 1 : 1\n    } : blog));\n  };\n  const handleDelete = async id => {\n    const blogObject = blogs.find(blog => blog.id === id);\n    if (window.confirm(`Remove ${blogObject.title} by ${blogObject.author} ?`)) {\n      blogService.remove(id);\n      setBlogs(blogs.filter(blog => blog !== blogObject));\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [user === null ? /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"log in to application\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Notification, {\n        message: errorMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(LoginForm, {\n        username: username,\n        password: password,\n        handleUsernameChange: _ref => {\n          let {\n            target\n          } = _ref;\n          return setUsername(target.value);\n        },\n        handlePasswordChange: _ref2 => {\n          let {\n            target\n          } = _ref2;\n          return setPassword(target.value);\n        },\n        handleSubmit: handleLogin\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"blogs\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Notification, {\n        message: errorMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [user.name, \" logged in\", /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleLogout,\n          children: \"logout\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"create new\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Togglable, {\n        buttonLabel: \"create new blog\",\n        ref: blogFormRef,\n        children: /*#__PURE__*/_jsxDEV(BlogForm, {\n          createBlog: addBlog\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 9\n    }, this), blogs.map(blog => /*#__PURE__*/_jsxDEV(Blog, {\n      blog: blog,\n      user: user,\n      handleLike: () => handleLike(blog.id),\n      handleDelete: () => handleDelete(blog.id)\n    }, blog.id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 9\n    }, this))]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 106,\n    columnNumber: 5\n  }, this);\n};\n_s(App, \"fwOeqHlfbNl3HEDl9jAZLPZVy4E=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["useState","useEffect","useRef","Blog","BlogForm","LoginForm","Notification","Togglable","blogService","loginService","require","App","blogs","setBlogs","errorMessage","setErrorMessage","username","setUsername","password","setPassword","user","setUser","blogFormRef","getAll","then","sort","a","b","likes","loggedUserJSON","window","localStorage","getItem","JSON","parse","setToken","token","handleLogin","event","preventDefault","login","setItem","stringify","exception","setTimeout","handleLogout","removeItem","addBlog","blogObject","current","toggleVisibility","title","author","create","returnedBlog","concat","handleLike","id","find","blog","newBlog","update","map","handleDelete","confirm","remove","filter","target","value","name"],"sources":["C:/Users/aaron/OneDrive/Documents/GitHub/Fullstack/part7/bloglist/frontend/src/App.js"],"sourcesContent":["import { useState, useEffect, useRef } from 'react'\n\nimport Blog from './components/Blog'\nimport BlogForm from './components/BlogForm'\nimport LoginForm from './components/LoginForm'\nimport Notification from './components/Notification'\nimport Togglable from './components/Togglable'\nimport blogService from './services/blogs'\nimport loginService from './services/login'\nrequire('express-async-errors')\n\nconst App = () => {\n  const [blogs, setBlogs] = useState([])\n  const [errorMessage, setErrorMessage] = useState(null)\n  const [username, setUsername] = useState('')\n  const [password, setPassword] = useState('')\n  const [user, setUser] = useState(null)\n\n  const blogFormRef = useRef()\n\n  useEffect(() => {\n    blogService.getAll().then((blogs) => {\n      blogs.sort((a, b) => (a.likes < b.likes ? 1 : -1))\n      setBlogs(blogs)\n    })\n  }, [])\n\n  useEffect(() => {\n    const loggedUserJSON = window.localStorage.getItem('loggedBlogAppUser')\n    if (loggedUserJSON) {\n      const user = JSON.parse(loggedUserJSON)\n      setUser(user)\n      blogService.setToken(user.token)\n    }\n  }, [])\n\n  const handleLogin = async (event) => {\n    event.preventDefault()\n\n    try {\n      const user = await loginService.login({\n        username,\n        password\n      })\n      window.localStorage.setItem('loggedBlogAppUser', JSON.stringify(user))\n      blogService.setToken(user.token)\n      setUser(user)\n      setUsername('')\n      setPassword('')\n    } catch (exception) {\n      setErrorMessage('wrong username or password')\n      setTimeout(() => {\n        setErrorMessage(null)\n      }, 5000)\n    }\n  }\n\n  const handleLogout = () => {\n    setUser(null)\n    window.localStorage.removeItem('loggedBlogAppUser')\n  }\n\n  const addBlog = (blogObject) => {\n    blogFormRef.current.toggleVisibility()\n    setErrorMessage(\n      `a new blog ${blogObject.title} by ${blogObject.author} added`\n    )\n    setTimeout(() => {\n      setErrorMessage(null)\n    }, 5000)\n\n    blogService.create(blogObject).then((returnedBlog) => {\n      setBlogs(blogs.concat({ ...returnedBlog, user: user }))\n    })\n  }\n\n  const handleLike = async (id) => {\n    const blogObject = blogs.find((blog) => blog.id === id)\n    const newBlog = {\n      ...blogObject,\n      likes: blogObject.likes + 1,\n      user: user.id\n    }\n    delete newBlog.id\n    await blogService.update(id, newBlog)\n    setBlogs(\n      blogs.map((blog) =>\n        blog.id === blogObject.id\n          ? { ...blog, likes: blog.likes > 0 ? blog.likes + 1 : 1 }\n          : blog\n      )\n    )\n  }\n\n  const handleDelete = async (id) => {\n    const blogObject = blogs.find((blog) => blog.id === id)\n    if (\n      window.confirm(`Remove ${blogObject.title} by ${blogObject.author} ?`)\n    ) {\n      blogService.remove(id)\n      setBlogs(blogs.filter((blog) => blog !== blogObject))\n    }\n  }\n\n  return (\n    <div>\n      {user === null ? (\n        <div>\n          <h1>log in to application</h1>\n          <Notification message={errorMessage} />\n          <LoginForm\n            username={username}\n            password={password}\n            handleUsernameChange={({ target }) => setUsername(target.value)}\n            handlePasswordChange={({ target }) => setPassword(target.value)}\n            handleSubmit={handleLogin}\n          />\n        </div>\n      ) : (\n        <div>\n          <h1>blogs</h1>\n          <Notification message={errorMessage} />\n          <p>\n            {user.name} logged in\n            <button onClick={handleLogout}>logout</button>\n          </p>\n          <h1>create new</h1>\n          <Togglable buttonLabel=\"create new blog\" ref={blogFormRef}>\n            <BlogForm createBlog={addBlog} />\n          </Togglable>\n        </div>\n      )}\n\n      {blogs.map((blog) => (\n        <Blog\n          key={blog.id}\n          blog={blog}\n          user={user}\n          handleLike={() => handleLike(blog.id)}\n          handleDelete={() => handleDelete(blog.id)}\n        />\n      ))}\n    </div>\n  )\n}\n\nexport default App\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}